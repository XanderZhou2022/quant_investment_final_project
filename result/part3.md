# 第三部分 数据与市场状态（Regime）识别

本研究在构建机器学习因子轮动模型之前，首先从传统实证角度检验因子收益是否具有随市场状态变化而显著不同的特征。因子轮动策略的前提是“不同因子在不同市场状态下具有系统性差异”，因此市场状态（Regime）的识别与因子表现的分解是本研究的核心基础工作。本部分通过构建因子多空收益序列、定义市场环境指标并识别 Regime，最终以数据驱动的方式验证因子轮动的存在性，为后续机器学习预测模型提供理论与经验依据。

---

## 3.1 因子数据构建

研究所采用的因子数据基于上证50指数的动态成分股，涵盖 2014 年 1 月至 2024 年 1 月期间所有月度截面。调仓周期设定为每月一次，因子构建按以下五类经典风格因子展开：

1. 动量因子：采用 20 日动量（MOM20）、120 日动量（MOM120）以及 RSI(14)；
2. 价值因子：采用市净率倒数 PB⁻¹、市盈率倒数 PE⁻¹、以及股息率；
3. 质量因子：包含 ROE_TTM 与利润增长率；
4. 风险因子：使用波动率因子与市场 Beta；
5. 规模因子：使用市值反映企业规模。

对于每个因子，在每月末计算截面因子值后进行五分位分组（基于 20% 分位数划分），并构造最高分组减最低分组（G5-G1）的多空组合收益。最终形成的因子收益矩阵 factor_longshort.csv 为一个“月份 × 因子”的时间序列数据集，反映各风格因子的月度超额收益结构。

这一部分的目的在于将所有因子收益标准化为可比较的横截面多空收益，使后续能够分析不同因子在不同市场环境下的表现差异。

---

## 3.2 市场状态（Regime）识别

为了研究因子在不同市场环境下是否呈现结构化轮动，本研究采用指数层面的宏观市场特征来识别市场状态。具体而言，基于上证50指数构建以下月度特征：

* 指数月度收益率（ret_month），表征市场趋势；
* 20 日与 60 日年化波动率（vol_20、vol_60），表征市场风险水平；
* 月度成交量总和及其变化（vol_sum、vol_chg），表征市场情绪与交易活跃度。

这些特征分别反映市场的趋势、风险与流动性，是金融研究中常用于识别市场状态的关键指标。对上述变量进行标准化后，采用 KMeans 聚类算法对市场状态进行无监督学习，旨在让市场自身的统计结构决定 Regime 的边界。

在比较各聚类数的 Silhouette Score 后，本研究选取 K=3 的划分，因为其不仅具有合理的聚类质量，同时与传统金融环境中的三类市场情形高度吻合。最终得到的三类 Regime 分别具有以下特征：

第一类（Regime_Bull）具有正向收益、正常成交量及较低波动率，对应市场温和上涨的环境；
第二类（Regime_Bear）表现为收益为负、波动略升，代表市场压力或风险偏好下降的阶段；
第三类（Regime_Sideways）呈现显著放大的成交量与最高的波动率，反映市场不确定性高、风格快速切换的震荡状态。

这一识别结果通过二维与三维可视化进一步得到了验证，不同 Regime 在收益、波动和成交活跃度上的空间分布清晰分离，说明聚类得到的市场状态具有统计显著性和经济解释性。

---

## 3.3 因子收益与市场状态的关系：因子轮动的实证证据

将识别得到的 Regime 标签与因子多空收益进行合并后，本研究对各因子在不同 Regime 下的平均收益、波动水平与夏普比进行了统计。结果显示，不同风格因子在三类 Regime 下表现出明显差异，具体体现在：

动量因子在 Regime_Bull 中表现最为突出，收益和夏普比均显著高于其他 Regime，体现趋势延续的典型特征；
价值因子和低波动因子在 Regime_Bear 中相对稳健，具有较低回撤和更高的风险调整收益，反映防御性风格在下行市场中的优势；
质量因子在 Regime_Sideways 中表现相对稳健，而动量因子在高震荡环境中收益显著下降，甚至可能出现反转。

这些结果不仅与现有因子投资文献中的结论一致，更证明在本研究所选取的中国上证50市场中，因子表现随市场状态发生系统性变化。换言之，因子溢价并非稳定不变，而是具有显著的状态依赖性。

---

## 3.4 本部分结论与方法论价值

通过上述实证分析，本研究在进入机器学习建模之前已经验证了一个关键事实：因子轮动确实存在，且与市场状态呈现明确的结构性关系。市场状态不仅可以通过指数特征可靠识别，而且能够解释因子收益的显著差异。这为后续引入 LSTM、Transformer 等时序模型捕捉 Regime 演变和因子收益之间的非线性关系提供了坚实基础。

本部分的工作将因子轮动从概念论证转变为数据驱动的事实，为整个研究建立了一条合理且严谨的逻辑链条：
市场存在状态 → 因子表现依赖状态 → 因子存在轮动 → 需要机器学习预测状态驱动的因子收益 → 生成动态因子权重以提升策略表现。

---

