---

## Slide 1：基于机器学习的动态因子轮动策略研究

**讲稿：**
大家好，我今天汇报的题目是《基于机器学习的动态因子轮动策略研究》。我们以上证50成分股为例，关注一个问题：不同风格因子会不会在不同市场环境下轮流占优？接下来我会按“研究动机—数据与方法—回测结果—结论与展望”的顺序，把整个研究过程和结果讲清楚。

---

## Slide 2：汇报目录

**讲稿：**
我先按目录带大家过一遍结构：前半部分讲为什么需要因子轮动，以及我们如何用数据验证“轮动”确实存在；后半部分讲模型怎么做、权重怎么生成、回测结果怎么样；最后做总结并讨论局限和可扩展方向。

---

## Slide 3：研究动机：因子配置是否应当保持不变？

**讲稿：**
传统多因子框架通常默认因子溢价长期稳定，所以很多策略的因子权重基本是不动的。但现实里我们经常看到：同一个因子在不同阶段表现差异很大，甚至会阶段性失效。所以一个自然的问题是：因子权重是不是应该随市场环境变化，而不是长期固定？

---

## Slide 4：因子收益非平稳性的经济直觉

**讲稿：**
从直觉上看，这种“时好时坏”并不奇怪。比如市场趋势明显时，动量更容易发挥；当市场情绪偏悲观、风险偏好下降时，价值和质量往往更抗跌、更稳。也就是说，因子的有效性很依赖当时的市场环境。如果一直用一套静态配置，就很容易在某些阶段“踩错节奏”。

---

## Slide 5：因子轮动的核心思想

**讲稿：**
因子轮动的想法其实很直接：既然因子在不同阶段表现不同，我们就尝试在不同风格之间动态调整权重。这里的目标不是去预测市场绝对收益，而是更好地在风格之间切换，在风险可控的前提下提升组合的整体收益质量。

---

## Slide 6：因子轮动在实践中的关键挑战

**讲稿：**
真正把轮动做成策略，主要有两个难点。第一，市场状态本身不可直接观测，很多时候容易变成主观划分；第二，因子收益噪声大、时序结构复杂，用简单规则很难稳定刻画。后面的方法就是围绕这两个问题，尽量用数据和机器学习做一个更客观、可重复的方案。

---

## Slide 7：研究思路：从因子轮动到数据驱动建模

**讲稿：**
所以整体思路分两步：先用指数层面的特征把市场状态客观识别出来，看看不同状态下因子强弱是否确实不同；在确认“轮动现象”成立之后，再用机器学习预测下一期各因子的相对强弱，并把预测结果转成可回测的动态权重。总体逻辑是“先验证现象，再讨论如何利用”。

---

## Slide 8：研究对象与研究目标

**讲稿：**
研究对象选上证50成分股，一方面成分相对稳定，另一方面流动性更好、交易约束更少，更接近可实施的环境。我们的核心目标是：在同样的样本外区间下，动态因子配置能不能在风险调整后收益上明显优于简单的静态多因子组合。

---

## Slide 9：研究对象与数据结构：两类数据、统一月度对齐

**讲稿：**
数据方面我们用月度频率。一类是因子多空收益的时间序列；另一类是指数层面的市场特征，用来识别 Regime。两类数据按月份严格对齐，并统一把日期映射到当月第一天，主要是为了保证预测和调仓只用到当时可见的信息，避免时间错配带来的“穿越”。

---

## Slide 10：数据示例：原始因子与指数数据片段

**讲稿：**
这一页展示原始数据大致长什么样，包括个股因子值、收益等字段，以及指数端的特征字段。后面的因子多空收益和 Regime 标签，都是在这套原始数据基础上加工出来的。

---

## Slide 11：风格因子选择：经典且可解释

**讲稿：**
因为我们想验证的是“轮动机制”，而不是做因子动物园，所以只选了动量、价值、质量和风险相关这几类经典因子。这样做一是维度更可控，过拟合风险更小；二是经济含义清晰，后面看到轮动现象时也更好解释。

---

## Slide 12：从横截面信号到时间序列：因子多空收益（Long--Short）

**讲稿：**
为了把横截面的因子信号变成可建模的时间序列，我们每个月把成分股按因子排序，做五分位分组，用高分组减低分组得到多空因子收益。这样可以在一定程度上剥离市场整体涨跌，更聚焦于因子溢价本身随时间怎么变化。

---

## Slide 13：市场状态信息：用指数层面特征刻画“环境”

**讲稿：**
Regime 识别这块，我们不用个股微观信息，而用上证50指数的月度收益、波动率、成交量等特征来刻画整体环境。直觉上它们分别对应市场方向、风险强度和资金情绪。把这些特征标准化后，再交给聚类算法去自动划分状态。

---

## Slide 14：市场状态识别所用数据示例

**讲稿：**
这里展示用于 Regime 划分的指数特征数据。每个月都有收益、波动、成交量等字段。KMeans 聚类就是在这个特征空间里，把“特征相近”的月份归到同一类。

---

## Slide 15：Regime 划分方法：KMeans + 轮廓系数选 K

**讲稿：**
我们没有预设牛熊，而是用 KMeans 这种无监督方法让数据自己分状态。然后用轮廓系数比较不同聚类数的效果，最后选了三类状态：一方面有统计区分度，另一方面也更便于做经济解释。

---

## Slide 16：三类市场状态的经济含义：收益--风险--成交

**讲稿：**
聚类完成后，我们回头看每一类在收益、波动和成交上的特征，就可以给它们贴上直观标签：比如低波动、收益偏正的“顺风期”，高波动、收益偏弱的“压力期”，以及方向不明显但成交活跃的“震荡期”。这一步是为了确认：聚出来的状态不仅统计上不同，也能讲得通。

---

## Slide 17：实证发现：因子收益对 Regime 高度敏感

**讲稿：**
接着我们把因子多空收益按 Regime 分组比较，发现不同状态下因子强弱确实有明显变化：趋势顺的时候动量更强；压力期里价值和防御因子更占优；震荡环境下质量因子相对更稳。也就是说，因子轮动不是拍脑袋，它在数据上能看得出来。

---

## Slide 18：本节结论：为何可以进入“预测 → 动态权重”主线？

**讲稿：**
这一页是对前面实证部分的收束：我们用指数特征识别出了相对稳定的市场状态，而且因子在不同状态下的表现确实不同。基于这两点，就可以把问题进一步转成一个预测任务：用历史因子收益（以及可选的状态信息）预测下一期相对强弱，再据此做动态配置。

---

## Slide 19：核心问题：预测之后如何形成可执行策略？

**讲稿：**
到这里自然会遇到下一个问题：就算预测出下一期哪些因子更强，怎么把这件事变成一套能跑回测、权重连续且可控的策略？接下来这一节就讲“预测输出”如何转换为因子权重，再落到组合上。

---

## Slide 20：因子轮动策略的整体流程

**讲稿：**
整体流程可以概括为三步：先预测下一期各因子的多空收益；再把预测值映射成因子权重；最后用权重构建组合并回测。这个流程尽量保持连续，不依赖主观规则切换。

---

## Slide 21：预测目标：相对强弱，而非绝对收益

**讲稿：**
这里再强调一下预测任务的定位：我们不追求精确预测每个因子的绝对收益，而更在意因子之间的相对强弱。只要模型在排序结构上提供了信息，即便绝对数值有误差，也可能通过权重调整改善组合表现。

---

## Slide 22：最终建模数据集：final_factor_longshort.csv

**讲稿：**
所有建模最终都收敛到这张表：final_factor_longshort.csv。每一行是一月份，包含十个因子的多空收益和当期 Regime 标签，后面的训练、验证、测试都基于这一份统一数据源展开。

---

## Slide 23：数据来源与时间范围

**讲稿：**
这张表由两部分合成：因子多空收益来自成分股分组构造；Regime 标签来自指数特征聚类。两者按月严格对齐后形成 2015 到 2024 的连续时间序列，用于后续建模。

---

## Slide 24：监督学习样本：12 个月滑动窗口

**讲稿：**
监督学习样本用 12 个月滑动窗口构造：用过去一年预测下一个月。这样在每个时点的预测只依赖历史信息，符合时间顺序，也更贴近真实投资里滚动更新的方式。

---

## Slide 25：模型输入特征的组成

**讲稿：**
输入特征包括两部分：十个因子的历史多空收益，以及 Regime 的 one-hot 编码。这样模型一方面能学习因子自身的时间结构，另一方面也能显式看到当前市场环境信息。

---

## Slide 26：样本划分：严格按时间顺序

**讲稿：**
金融时间序列不能随机打乱划分，否则容易把未来信息泄露到过去。我们完全按时间往前推：早期做训练，中间做验证，最后留出测试。这样测试结果才真正具有样本外意义。

---

## Slide 27：测试集区间与样本外评估

**讲稿：**
测试区间是 2024 年 2 月到 12 月。进入测试阶段后，模型结构和参数都已经确定，不再训练或调参，只做预测并用于回测，所以这段可以看作对整个方法的样本外检验。

---

## Slide 28：前视偏差控制说明

**讲稿：**
这里专门强调前视偏差控制：因子收益和 Regime 都是用当期及以前的信息计算；训练、验证、测试严格按时间划分；测试期不参与任何训练或调参。这保证了实验的信息使用顺序与真实交易一致。

---

## Slide 29：预测—配置—回测的时间一致性

**讲稿：**
在每个测试月，我们先用之前 12 个月数据预测下一期因子收益，再根据预测生成当期权重，最后用这个权重跑当月收益。整个过程严格执行“先预测、再配置、后实现收益”的顺序，所以最终收益路径具备可解释性。

---

## Slide 30：建模目标：预测下一期因子相对表现

**讲稿：**
模型部分开始前再统一一下目标：我们预测的是“下一期十个因子的多空收益向量”。不预测个股，也不预测指数方向，核心是服务于后续的权重生成和轮动配置。

---

## Slide 31：为什么联合预测（Multi-output）？

**讲稿：**
因子之间并不是独立的，风险偏好变化时很多风格会一起变强或变弱。如果每个因子单独训练模型，既忽视这种联动结构，也会在月度样本有限时更容易过拟合。因此我们用一个模型同时输出十个因子的预测。

---

## Slide 32：模型选择：LSTM

**讲稿：**
因子收益是噪声较大的时间序列，但通常存在阶段性和一定的“记忆效应”。LSTM 擅长处理这类序列依赖结构，同时能接收多维输入，在样本不算特别大的情况下也相对稳健，所以选它作为基线模型。

---

## Slide 33：输入输出张量结构

**讲稿：**
每个样本输入是一段 12 个月的序列，每个月包含因子收益和 Regime 特征；输出是一条十维向量，对应下个月十个因子的预测值。这就是一个标准的多输出时间序列回归任务。

---

## Slide 34：网络结构概览

**讲稿：**
结构上比较朴素：一层 64 单元 LSTM 提取序列表示，中间加 Dropout 抑制过拟合，再接一个全连接层增强非线性表达，最后用 10 维线性层输出各因子的预测。这里重点是把问题定义清楚，而不是堆复杂结构。

---

## Slide 35：训练设置

**讲稿：**
训练采用常用配置：MSE 作为损失，Adam 优化器，80 个 epoch，小 batch。更关键的是训练过程一直用验证集监控，避免模型只在训练集“学得很好”但样本外失真。

---

## Slide 36：样本外预测与时间对齐

**讲稿：**
训练好后在测试集上预测，会得到因子收益预测矩阵。因为用了 12 个月滑窗，需要把预测结果和真实月份严格对齐，确保每一行预测对应正确的调仓月。之后导出 factor_prediction.csv，供回测使用。

---

## Slide 37：模型角色小结

**讲稿：**
总结一下：我们训练的是一个多任务时间序列预测模型，它的输出不是直接交易信号，而是作为 softmax 映射和动态权重生成的输入。策略有没有价值，最终要看下一部分的回测结果。

---

## Slide 38：回测设定与统一口径

**讲稿：**
进入回测环节。这里先把口径统一：只看样本外区间，以上证50为基准，月度调仓。所有策略都在同一个时间段、同一种调仓频率下比较，保证对比公平。

---

## Slide 39：特征标准化与归一化示例

**讲稿：**
在进入权重计算和回测之前，我们对特征做标准化/归一化处理，主要是避免量纲差异导致某些因子被不合理放大，也让后续权重计算更稳定。

---

## Slide 40：回测记录示意

**讲稿：**
回测过程中，我们在每个月记录权重、收益、净值等关键字段。后面所有指标和图表，都是基于这些完整记录计算得到的。

---

## Slide 41：对照策略定义（四策略）

**讲稿：**
为了判断动态权重是否真的有增量价值，我们设置四类策略对照：等权多因子、规则配置、以及有/无 Regime 的动态权重版本。后面的结果就是围绕这四条曲线比较。

---

## Slide 42：策略核心指标总览

**讲稿：**
先看核心指标总览：动态权重，尤其是不含状态的版本，在年化收益、Sharpe、Calmar 等指标上更突出，同时最大回撤也更小。也就是说，在这段样本外窗口里，“预测 + softmax 动态权重”整体优于静态和规则配置。

---

## Slide 43：累计收益期末对比

**讲稿：**
如果只看期末累计收益，动态权重策略同样明显领先，并且四种策略都跑赢基准。这里主要是用一个直观数字让大家快速感受收益量级差异。

---

## Slide 44：累计收益曲线

**讲稿：**
曲线把收益路径展示得更清楚：动态权重策略整体更陡、回撤更浅。相比只看期末结果，这张图能更直观看到收益是如何累积出来的。

---

## Slide 45：相对基准表现（CAPM / IR）

**讲稿：**
在相对基准维度，我们看年化超额收益、跟踪误差和信息比率。动态权重（无状态）在 IR 上最好，意味着在单位跟踪误差意义下，它产生的超额收益更稳定、更高效。

---

## Slide 46：信息比率对比

**讲稿：**
这页用柱状图把 IR 对比得更直观。动态权重两个版本都显著高于静态策略，进一步说明动态配置在相对基准意义下更有效率。

---

## Slide 47：回撤曲线对比

**讲稿：**
再看尾部风险。回撤曲线显示动态权重（尤其无状态版本）回撤更浅、修复更快，说明收益提升不是靠“拼波动”换来的。

---

## Slide 48：Sharpe 对比

**讲稿：**
从 Sharpe 角度看，排序和之前结论一致：动态权重在单位波动的回报上更有优势。把 Sharpe 和 IR 放在一起，相当于从绝对风险和相对风险两个维度都做了验证。

---

## Slide 49：换手率与单位换手收益

**讲稿：**
考虑交易成本，我们比较了平均换手率以及单位换手收益。结果是：含 Regime 的版本换手更低、单位效率更高；无 Regime 的版本换手稍高，但绝对收益更强。两者在“收益 vs 交易成本”上各有取舍。

---

## Slide 50：因子层面诊断：多空收益与 IC

**讲稿：**
把视角拉回到因子层面，我们看多空收益和 IC。这里的 IC 指的是信息系数，可以理解为“因子打分和下一期收益之间的相关性”，用来衡量因子信号有没有预测力。从结果看，这些指标整体并不突出，甚至偏弱。这提示我们：动态策略的优势不是因为每个因子都预测得特别准，更可能是组合层面通过动态调权，把有限的预测信息更有效地转化成了收益表现。

---

## Slide 51：区分度检验（T-Stat / P-Value）

**讲稿：**
区分度检验也没有显示出很强的统计显著性，这和 IC 的结论一致。所以更稳妥的表述是：本文展示的是一种在因子显著性有限的背景下，通过工程化权重调整改善组合收益–风险结构的思路，而不是证明因子预测本身显著增强。

---

## Slide 52：回测结论

**讲稿：**
综合收益、风险、相对基准和可实施性指标，动态因子权重整体优于静态策略，其中无 Regime 的版本在这段样本外窗口里表现最优。含 Regime 的版本也有改善，但边际贡献在这段样本中并不稳定，这一点我们在结论里会如实说明。

---

## Slide 53：研究问题回顾

**讲稿：**
最后回到最初的问题：在因子收益明显随时间变化的背景下，中国市场能不能用数据驱动的方法构建一套有效的因子轮动策略？为此我们从因子构建、Regime 识别，到时间序列预测和动态权重回测，搭建了完整流程并做了样本外检验。

---

## Slide 54：核心结论一

**讲稿：**
第一条结论是：样本外测试期内，基于预测并通过 softmax 生成的动态因子权重，在收益和风险调整后指标上整体优于等权和规则配置；而且这种提升不是单纯放大风险，而是在 Sharpe、IR、Calmar 等多个维度同时改善收益–风险结构。

---

## Slide 55：核心结论二

**讲稿：**
第二条结论是：从因子统计角度，我们并没有看到 IC 或显著性明显增强。也就是说，我们不是把某几个因子“预测得特别准”，而是通过在多个因子之间动态调权，让组合路径和风险暴露更合理，这更偏向一种组合层面的工程改良。

---

## Slide 56：核心结论三

**讲稿：**
第三条结论与 Regime 有关：理论上引入状态信息有直觉基础，但在这段相对短的样本外窗口里，它并没有稳定带来额外收益，部分指标还略逊。我们倾向于把这理解为样本长度与状态转移次数的限制，而不是对 Regime 思路本身的否定。

---

## Slide 57：研究局限性

**讲稿：**
局限性主要有三点：第一，样本外区间较短，年化指标对个别月份更敏感；第二，Regime 仅基于指数特征划分，尚未纳入更丰富的宏观或政策变量；第三，交易成本目前主要用换手率做近似，若面向实盘还需要更细致地建模流动性和冲击成本。

---

## Slide 58：未来研究方向

**讲稿：**
未来可以从三个方向扩展：一是拉长样本期、换不同市场做稳健性检验；二是引入更多宏观、流动性或情绪指标，更精细刻画市场状态；三是在 softmax 权重生成环节显式加入风险与换手惩罚，进一步向“收益–风险联合优化”的配置框架推进。

---

## Slide 59：总结

**讲稿：**
最后做个收束：这项研究表明，即使在因子统计显著性并不强的环境下，通过机器学习预测与动态权重机制，仍可能在组合层面明显改善收益–风险表现。更重要的是，我们提供了一套相对可复现、可扩展的研究流程，为后续把机器学习更系统地融入多因子配置提供了一个可以继续打磨的基础。

---

